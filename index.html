<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Safari Stay ‚Äì Mombasa Hotel</title>

  <style>
    *{ box-sizing:border-box; }
    :root{
      --bg:#0b1220;
      --card:#0f1b33;
      --text:#eaf1ff;
      --muted:#9fb3d6;
      --accent:#ffd36e;
      --danger:#ff7b7b;
      --ok:#7dffb2;
      --sky:#65d6ff;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
    }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 600px at 20% 10%, #132a66 0%, #0b1220 55%, #07101f 100%);
      min-height:100vh;
    }

    .topbar{
      position:sticky; top:0; z-index:10;
      display:flex; gap:14px; align-items:center; justify-content:space-between;
      padding:14px 16px;
      backdrop-filter: blur(10px);
      background: rgba(8,13,24,.55);
      border-bottom: 1px solid rgba(255,255,255,.06);
    }

    .brand{ display:flex; align-items:center; gap:12px; }
    .logo{
      width:44px; height:44px; border-radius:14px;
      display:grid; place-items:center;
      background: rgba(255,255,255,.06);
      box-shadow: var(--shadow);
      font-size:22px;
    }
    .title{ font-weight:800; letter-spacing:.3px; }
    .subtitle{ color:var(--muted); font-size:13px; margin-top:2px; }

    .stats{ display:flex; flex-wrap:wrap; gap:10px; justify-content:flex-end; }
    .pill{
      padding:8px 10px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.07);
      border-radius: 999px;
      font-size:13px;
      white-space:nowrap;
    }

    .wrap{
      max-width: 1200px;
      margin: 18px auto;
      padding: 0 16px 24px;
      display:grid;
      grid-template-columns: 380px 1fr;
      gap:16px;
    }

    .card{
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.07);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 14px;
    }

    h2{ margin: 0 0 10px; font-size:18px; }
    h3{ margin: 0 0 10px; font-size:15px; }
    .muted{ color: var(--muted); line-height:1.4; }
    .small{ font-size: 13px; }

    .actions{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top:10px;
    }

    .btn{
      border:0;
      padding:10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.08);
      color: var(--text);
      cursor:pointer;
      font-weight:700;
      border: 1px solid rgba(255,255,255,.08);
    }
    .btn:hover{ transform: translateY(-1px); }
    .btn:active{ transform: translateY(0); }
    .btnGold{ background: rgba(255,211,110,.14); border-color: rgba(255,211,110,.25); }
    .btnDanger{ background: rgba(255,123,123,.12); border-color: rgba(255,123,123,.22); }

    .divider{
      height:1px;
      background: rgba(255,255,255,.08);
      margin: 14px 0;
    }

    .menu{
      display:flex; gap:10px; flex-wrap:wrap;
      margin: 10px 0 8px;
    }
    .menu button{
      flex: 1 0 auto;
      min-width: 110px;
    }

    .selected{
      font-size: 13px;
      color: var(--muted);
      margin-top: 8px;
    }

    .toast{
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(101,214,255,.10);
      border: 1px solid rgba(101,214,255,.22);
      color: var(--text);
      display:none;
    }

    .hotelGrid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }

    .room{
      border-radius: 18px;
      padding: 12px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.08);
      position: relative;
      overflow:hidden;
      cursor:pointer;
    }

    .roomHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin-bottom: 8px;
    }
    .roomName{ font-weight: 900; }

    .badge{
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 12px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
    }
    .badge.clean{ border-color: rgba(125,255,178,.25); background: rgba(125,255,178,.10); }
    .badge.dirty{ border-color: rgba(255,123,123,.25); background: rgba(255,123,123,.10); }
    .badge.cleaning{ border-color: rgba(255,211,110,.25); background: rgba(255,211,110,.12); }
    .badge.occupied{ border-color: rgba(101,214,255,.25); background: rgba(101,214,255,.10); }

    .roomBody{
      display:flex; justify-content:space-between; gap:10px; align-items:flex-start;
    }

    .roomLeft .emoji{
      font-size: 28px;
      line-height:1;
    }
    .roomLeft .guestLine{
      margin-top: 6px;
      color: var(--muted);
      font-size: 13px;
    }

    .roomRight{
      display:flex; flex-direction:column; gap:8px; align-items:flex-end;
      width: 58%;
    }

    .roomBtn{
      width: 100%;
      border:0;
      padding:9px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.08);
      color: var(--text);
      cursor:pointer;
      font-weight: 800;
      border: 1px solid rgba(255,255,255,.08);
    }
    .roomBtn:disabled{
      opacity:.55;
      cursor:not-allowed;
    }

    .orderRow{
      width:100%;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }

    .orderTag{
      font-size: 13px;
      padding: 6px 8px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.06);
      color: var(--text);
      width: 100%;
      text-align:left;
      line-height:1.25;
    }

    /* TIMER RING */
    .timerRing{
      --p: 0;
      --c: #7dffb2;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      display:grid;
      place-items:center;
      background:
        conic-gradient(var(--c) calc(var(--p) * 1%), rgba(255,255,255,.10) 0);
      border: 1px solid rgba(255,255,255,.12);
      flex: 0 0 auto;
    }
    .timerRing::after{
      content:"";
      width: 26px;
      height: 26px;
      border-radius: 50%;
      background: rgba(10,16,30,.95);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
    }
    .timerWrap{
      position: relative;
      width: 36px;
      height: 36px;
      display:grid;
      place-items:center;
    }
    .timerFace{
      position:absolute;
      font-size: 15px;
      pointer-events:none;
    }

    .pulse{ animation: pulse 0.85s infinite; }
    @keyframes pulse{
      0%{ transform: scale(1); }
      50%{ transform: scale(1.06); }
      100%{ transform: scale(1); }
    }

    @media (max-width: 980px){
      .wrap{ grid-template-columns: 1fr; }
      .stats{ justify-content:flex-start; }
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">ü¶Å</div>
      <div>
        <div class="title">Safari Stay</div>
        <div class="subtitle">Mombasa Hotel</div>
      </div>
    </div>

    <div class="stats">
      <div class="pill">üí∞ Coins: <span id="coins">0</span></div>
      <div class="pill">üßπ Cleaners: <span id="cleaners">1</span></div>
      <div class="pill">üßç Queue: <span id="queue">0</span></div>
      <div class="pill">ü§µ Bellboy: <span id="bellboy">Ready</span></div>
    </div>
  </header>

  <main class="wrap">
    <section class="left">
      <div class="card">
        <h2>Reception</h2>
        <p class="muted">
          Flow: Guest checks in ‚Üí (guaranteed) order appears ‚Üí you deliver ‚Üí guest checks out later.
          Mood: üôÇ ‚Üí üòê ‚Üí üò†
        </p>

        <div class="actions">
          <button id="btnSpawn" class="btn">‚ûï Spawn Guest</button>
          <button id="btnHireCleaner" class="btn btnGold">Hire Cleaner (upgrade)</button>
          <button id="btnReset" class="btn btnDanger">Reset Save</button>
        </div>

        <div class="divider"></div>

        <h3>Snack Corner (Delivery)</h3>
        <p class="muted small">Step 1: Click a snack. Step 2: Click the room that ordered it.</p>

        <div class="menu" id="menu"></div>

        <div class="selected">
          Selected item: <span id="selectedItem">None</span>
        </div>

        <div class="toast" id="toast" aria-live="polite"></div>
      </div>
    </section>

    <section class="right">
      <div class="card">
        <h2>Your Hotel</h2>
        <div class="hotelGrid" id="hotelGrid"></div>
      </div>
    </section>
  </main>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const $ = (sel) => document.querySelector(sel);

      const hotelGrid = $("#hotelGrid");
      const coinsEl = $("#coins");
      const cleanersEl = $("#cleaners");
      const queueEl = $("#queue");
      const bellboyEl = $("#bellboy");
      const toastEl = $("#toast");
      const selectedItemEl = $("#selectedItem");
      const menuEl = $("#menu");

      // TIMING
      const CLEAN_TIME_MS = 3000;

      // Order lifecycle
      const ORDER_APPEAR_MS = 1600;      // guaranteed order appears
      const ORDER_TOTAL_MS  = 12000;     // timer to deliver before angry
      const ANGRY_LEAVE_MS  = 9000;      // if still waiting this long after angry -> leaves

      const DELIVERY_TRAVEL_MS = 1200;   // bellboy travel time
      const POST_DELIVERY_STAY_MS = 4500;// checkout happens after delivery

      const MENU = [
        { key: "juice",  label: "ü•§ Juice",  price: 5 },
        { key: "chips",  label: "üçü Chips",  price: 6 },
        { key: "coffee", label: "‚òï Coffee", price: 7 },
      ];

      const KEY = {
        coins: "mombasaCoins",
        queue: "mombasaQueue",
        rooms: "mombasaRoomsState",
        cleaners: "mombasaCleanersOwned",
      };

      let coins = Number(localStorage.getItem(KEY.coins)) || 0;
      let queue = Number(localStorage.getItem(KEY.queue)) || 0;
      let cleanersOwned = Number(localStorage.getItem(KEY.cleaners)) || 1;

      let selectedItemKey = null;

      let bellboy = { isBusy:false, deliveringToRoomId:null, itemKey:null };
      let cleaningInProgress = 0;

      let rooms = loadRooms() || [mkRoom(1), mkRoom(2), mkRoom(3), mkRoom(4)];
      let guestSeq = 1;

      buildMenuUI();
      wireButtons();
      renderHotel();

      setInterval(tryAssignGuestsToRooms, 650);

      // smooth ring updates
      setInterval(() => {
        if (rooms.some(r => r.order && (r.order.status === "waiting" || r.order.status === "delivering"))) renderHotel();
      }, 250);

      function mkRoom(id){
        return {
          id,
          status:"clean",
          guestId:null,
          order:null,     // { itemKey, status, createdAt, deadlineAt }
          timers:null
        };
      }

      function loadRooms(){
        try{
          const raw = localStorage.getItem(KEY.rooms);
          if (!raw) return null;
          const parsed = JSON.parse(raw);
          // IMPORTANT: old timestamps can be expired -> safest is to wipe active orders on load
          // so you don't get "instant leave" from stale saved timers
          parsed.forEach(r => {
            r.timers = null;
            if (r.order && r.order.status && r.order.status !== "delivered") {
              // keep UI simple and stable on reload
              r.order = null;
            }
          });
          return parsed;
        }catch(e){
          return null;
        }
      }

      function saveAll(){
        localStorage.setItem(KEY.coins, String(coins));
        localStorage.setItem(KEY.queue, String(queue));
        localStorage.setItem(KEY.cleaners, String(cleanersOwned));
        localStorage.setItem(KEY.rooms, JSON.stringify(rooms));
      }

      function toast(msg){
        toastEl.style.display = "block";
        toastEl.textContent = msg;
        clearTimeout(toastEl._t);
        toastEl._t = setTimeout(() => toastEl.style.display = "none", 2200);
      }

      function wireButtons(){
        $("#btnSpawn").addEventListener("click", spawnGuest);
        $("#btnHireCleaner").addEventListener("click", upgradeCleaner);

        // ‚úÖ Use this after pasting to clear old saved state
        $("#btnReset").addEventListener("click", () => {
          Object.values(KEY).forEach(k => localStorage.removeItem(k));
          location.reload();
        });
      }

      function buildMenuUI(){
        menuEl.innerHTML = "";
        MENU.forEach(item => {
          const btn = document.createElement("button");
          btn.className = "btn";
          btn.textContent = `${item.label} (+${item.price})`;
          btn.addEventListener("click", () => selectMenuItem(item.key));
          menuEl.appendChild(btn);
        });
      }

      function spawnGuest(){
        queue++;
        saveAll();
        renderHotel();
        toast("Guest arrived ‚úÖ");
        tryAssignGuestsToRooms();
      }

      function tryAssignGuestsToRooms(){
        if (queue <= 0) return;
        const freeRoom = rooms.find(r => r.status === "clean" && r.guestId === null);
        if (!freeRoom) return;

        queue--;
        checkInGuest(freeRoom.id);
        saveAll();
        renderHotel();
      }

      function checkInGuest(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;

        room.status = "occupied";
        room.guestId = guestSeq++;
        room.order = null;

        room.timers = room.timers || {};
        clearTimeout(room.timers.orderTimeout);
        clearTimeout(room.timers.leaveTimeout);
        clearTimeout(room.timers.checkoutTimeout);

        room.timers.orderTimeout = setTimeout(() => createOrder(roomId), ORDER_APPEAR_MS);
      }

      function createOrder(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;
        if (room.status !== "occupied") return;
        if (room.order) return; // already has one

        const item = MENU[Math.floor(Math.random() * MENU.length)];
        const now = Date.now();

        room.order = {
          itemKey: item.key,
          status: "waiting",
          createdAt: now,
          deadlineAt: now + ORDER_TOTAL_MS
        };

        room.timers = room.timers || {};
        clearTimeout(room.timers.leaveTimeout);
        room.timers.leaveTimeout = setTimeout(() => angryLeave(roomId), ORDER_TOTAL_MS + ANGRY_LEAVE_MS);

        saveAll();
        renderHotel();
        toast(`Room ${roomId} ordered ${item.label}`);
      }

      function angryLeave(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;
        if (room.status !== "occupied") return;

        // ‚úÖ only leave if still WAITING (not delivering, not delivered)
        if (!room.order || room.order.status !== "waiting") return;

        toast(`Guest in Room ${roomId} left angry üò†üí®`);

        room.status = "dirty";
        room.guestId = null;
        room.order = null;

        if (room.timers?.orderTimeout) clearTimeout(room.timers.orderTimeout);
        if (room.timers?.leaveTimeout) clearTimeout(room.timers.leaveTimeout);
        if (room.timers?.checkoutTimeout) clearTimeout(room.timers.checkoutTimeout);
        room.timers = null;

        saveAll();
        renderHotel();
      }

      function upgradeCleaner(){
        const cost = 80 * cleanersOwned;
        if (coins < cost){ toast(`Need ${cost} coins to hire another cleaner.`); return; }
        coins -= cost;
        cleanersOwned++;
        saveAll();
        renderHotel();
        toast(`Cleaner hired! You now have ${cleanersOwned} cleaner(s).`);
      }

      function canStartCleaning(){ return cleaningInProgress < cleanersOwned; }

      function startCleaning(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;

        if (room.status !== "dirty"){ toast(`Room ${roomId} is not dirty.`); return; }
        if (!canStartCleaning()){
          toast("All cleaners are busy. Upgrade to clean more rooms at once.");
          return;
        }

        room.status = "cleaning";
        cleaningInProgress++;
        saveAll();
        renderHotel();

        setTimeout(() => {
          room.status = "clean";
          cleaningInProgress = Math.max(0, cleaningInProgress - 1);
          saveAll();
          renderHotel();
          toast(`Room ${roomId} is clean ‚úÖ`);
          tryAssignGuestsToRooms();
        }, CLEAN_TIME_MS);
      }

      function selectMenuItem(itemKey){
        const item = MENU.find(m => m.key === itemKey);
        if (!item) return;

        selectedItemKey = itemKey;
        selectedItemEl.textContent = item.label;
        renderHotel();
        toast(`Selected ${item.label}. Now click the room.`);
      }

      function onRoomClicked(roomId){
        if (selectedItemKey) attemptDelivery(roomId);
      }

      function attemptDelivery(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;

        if (bellboy.isBusy){ toast("Bellboy is busy delivering another order."); return; }
        if (room.status !== "occupied"){ toast("No guest here."); return; }
        if (!room.order || room.order.status !== "waiting"){ toast("This room has no waiting order."); return; }

        if (room.order.itemKey !== selectedItemKey){
          const orderedLabel = MENU.find(m => m.key === room.order.itemKey)?.label || room.order.itemKey;
          toast(`Wrong item. Guest ordered ${orderedLabel}.`);
          return;
        }

        // ‚úÖ CRITICAL FIX: cancel leave timer IMMEDIATELY and lock order as "delivering"
        if (room.timers?.leaveTimeout) clearTimeout(room.timers.leaveTimeout);
        room.order.status = "delivering";

        bellboy.isBusy = true;
        bellboy.deliveringToRoomId = roomId;
        bellboy.itemKey = selectedItemKey;

        selectedItemKey = null;
        selectedItemEl.textContent = "None";

        saveAll();
        renderHotel();
        toast("Bellboy delivering‚Ä¶ ü§µ");

        setTimeout(() => {
          // room might have changed, re-grab it safely
          const r = rooms.find(x => x.id === roomId);
          if (!r || r.status !== "occupied" || !r.order) {
            bellboy.isBusy = false;
            bellboy.deliveringToRoomId = null;
            bellboy.itemKey = null;
            saveAll(); renderHotel();
            return;
          }

          r.order.status = "delivered";
          const earn = MENU.find(m => m.key === bellboy.itemKey)?.price || 0;
          coins += earn;

          bellboy.isBusy = false;
          bellboy.deliveringToRoomId = null;
          bellboy.itemKey = null;

          saveAll();
          renderHotel();
          toast(`Delivered ‚úÖ +${earn} coins`);

          // ‚úÖ checkout only after delivery
          r.timers = r.timers || {};
          clearTimeout(r.timers.checkoutTimeout);
          r.timers.checkoutTimeout = setTimeout(() => checkoutAfterDelivery(roomId), POST_DELIVERY_STAY_MS);

        }, DELIVERY_TRAVEL_MS);
      }

      function checkoutAfterDelivery(roomId){
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;
        if (room.status !== "occupied") return;
        if (!room.order || room.order.status !== "delivered") return;

        coins += 10; // stay reward

        room.status = "dirty";
        room.guestId = null;
        room.order = null;

        if (room.timers?.orderTimeout) clearTimeout(room.timers.orderTimeout);
        if (room.timers?.leaveTimeout) clearTimeout(room.timers.leaveTimeout);
        if (room.timers?.checkoutTimeout) clearTimeout(room.timers.checkoutTimeout);
        room.timers = null;

        saveAll();
        renderHotel();
        toast(`Guest checked out. Room ${roomId} is DIRTY üßº`);
      }

      function getOrderTimerVisual(order){
        // if delivering/delivered, show calm state (no angry countdown)
        if (order.status === "delivering") return { pct: 100, color:"#65d6ff", face:"üèÉ", pulse:false };
        if (order.status === "delivered")  return { pct: 100, color:"#7dffb2", face:"‚úÖ", pulse:false };

        const now = Date.now();
        const total = Math.max(1, order.deadlineAt - order.createdAt);
        const remaining = order.deadlineAt - now;
        const pct = Math.max(0, Math.min(100, (remaining / total) * 100));

        // 3-stage mood: üôÇ (green) >66, üòê (yellow) 33..66, üò† (red) <=33 or time up
        let color = "#7dffb2", face = "üôÇ", pulse = false;
        if (pct <= 66){ color = "#ffd36e"; face = "üòê"; }
        if (pct <= 33){ color = "#ff7b7b"; face = "üò†"; pulse = true; }
        if (remaining <= 0){ color = "#ff7b7b"; face = "üò†"; pulse = true; }

        return { pct, color, face, pulse };
      }

      function renderHotel(){
        coinsEl.textContent = coins;
        cleanersEl.textContent = cleanersOwned;
        queueEl.textContent = queue;
        bellboyEl.textContent = bellboy.isBusy ? `Delivering‚Ä¶ (Room ${bellboy.deliveringToRoomId})` : "Ready";

        hotelGrid.innerHTML = "";

        rooms.forEach(room => {
          const card = document.createElement("div");
          card.className = "room";
          card.addEventListener("click", () => onRoomClicked(room.id));

          const header = document.createElement("div");
          header.className = "roomHeader";

          const name = document.createElement("div");
          name.className = "roomName";
          name.textContent = `Room ${room.id}`;

          const badge = document.createElement("div");
          badge.className = "badge " + (
            room.status === "clean" ? "clean" :
            room.status === "dirty" ? "dirty" :
            room.status === "cleaning" ? "cleaning" :
            room.status === "occupied" ? "occupied" : ""
          );
          badge.textContent =
            room.status === "clean" ? "CLEAN" :
            room.status === "dirty" ? "DIRTY" :
            room.status === "cleaning" ? "CLEANING" :
            room.status === "occupied" ? "OCCUPIED" : room.status.toUpperCase();

          header.appendChild(name);
          header.appendChild(badge);

          const body = document.createElement("div");
          body.className = "roomBody";

          const left = document.createElement("div");
          left.className = "roomLeft";

          const emoji = document.createElement("div");
          emoji.className = "emoji";
          emoji.textContent =
            room.status === "occupied" ? "üß≥" :
            room.status === "dirty" ? "üßº" :
            room.status === "cleaning" ? "ü´ß" : "üõèÔ∏è";

          const guestLine = document.createElement("div");
          guestLine.className = "guestLine";
          guestLine.textContent =
            room.status === "occupied" ? `Guest #${room.guestId}` :
            room.status === "dirty" ? "Needs cleaning" :
            room.status === "cleaning" ? "Cleaning..." : "Available";

          left.appendChild(emoji);
          left.appendChild(guestLine);

          const right = document.createElement("div");
          right.className = "roomRight";

          const orderRow = document.createElement("div");
          orderRow.className = "orderRow";

          const orderTag = document.createElement("div");
          orderTag.className = "orderTag";

          const timerWrap = document.createElement("div");
          timerWrap.className = "timerWrap";

          if (room.status === "occupied" && room.order){
            const label = MENU.find(m => m.key === room.order.itemKey)?.label || room.order.itemKey;

            if (room.order.status === "waiting") orderTag.textContent = `Order: ${label}`;
            if (room.order.status === "delivering") orderTag.textContent = `Delivering: ${label}`;
            if (room.order.status === "delivered") orderTag.textContent = `Delivered ‚úÖ`;

            const v = getOrderTimerVisual(room.order);

            const ring = document.createElement("div");
            ring.className = "timerRing";
            ring.style.setProperty("--p", v.pct.toFixed(1));
            ring.style.setProperty("--c", v.color);
            if (v.pulse) ring.classList.add("pulse");

            const face = document.createElement("div");
            face.className = "timerFace";
            face.textContent = v.face;

            timerWrap.appendChild(ring);
            timerWrap.appendChild(face);

          } else if (room.status === "occupied") {
            orderTag.textContent = "Waiting to order‚Ä¶";
            orderTag.style.opacity = "0.75";
            timerWrap.style.visibility = "hidden";
          } else {
            orderTag.textContent = "‚Äî";
            orderTag.style.opacity = "0.55";
            timerWrap.style.visibility = "hidden";
          }

          orderRow.appendChild(orderTag);
          orderRow.appendChild(timerWrap);

          const cleanBtn = document.createElement("button");
          cleanBtn.className = "roomBtn";
          cleanBtn.textContent =
            room.status === "dirty" ? "üßπ CLEAN" :
            room.status === "cleaning" ? "Cleaning‚Ä¶" : "Clean";

          cleanBtn.disabled = !(room.status === "dirty" && canStartCleaning());

          cleanBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            startCleaning(room.id);
          });

          right.appendChild(orderRow);
          right.appendChild(cleanBtn);

          body.appendChild(left);
          body.appendChild(right);

          card.appendChild(header);
          card.appendChild(body);

          hotelGrid.appendChild(card);
        });

        saveAll();
      }
    });
  </script>
</body>
</html>
